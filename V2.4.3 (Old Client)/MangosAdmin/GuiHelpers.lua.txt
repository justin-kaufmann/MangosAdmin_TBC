-- ========= GuiHelpers.lua =========
MangosAdmin = MangosAdmin or {}
MangosAdmin.UI = MangosAdmin.UI or {}

-- Content zurÃ¼cksetzen und neuen Container erzeugen
function MangosAdmin.ResetContent()
  local ui = MangosAdmin.UI
  if not ui.scroll then return end

  local new = CreateFrame("Frame", nil, ui.scroll)
  new:SetWidth(ui.scrollWidth or 400)
  new:SetHeight(ui.scrollHeight or 400)

  ui.scroll:SetScrollChild(new)
  if ui.currentContent then ui.currentContent:Hide() end
  ui.currentContent = new
  return new
end

-- ScrollhÃ¶he anpassen
function MangosAdmin.SetScrollHeight(total)
  local ui = MangosAdmin.UI
  if not ui.scroll or not ui.scrollbar or not ui.currentContent then return end

  if total < (ui.scrollHeight or 0) then
    total = ui.scrollHeight
  end

  ui.currentContent:SetHeight(total)
  ui.scrollbar:SetMinMaxValues(0, total - (ui.scrollHeight or 0))
  ui.scrollbar:SetValue(0)
  ui.scroll:SetVerticalScroll(0)
end

-- Zeilencontainer erzeugen
function MangosAdmin.CreateRow(parent, y, height)
  local ui = MangosAdmin.UI
  local row = CreateFrame("Frame", nil, parent)
  row:SetWidth((ui.scrollWidth or 400) - 24)
  row:SetHeight(height or 46)
  row:SetPoint("TOPLEFT", parent, "TOPLEFT", 8, y)
  return row
end

-- Editbox mit Label erzeugen
function MangosAdmin.CreateEdit(parent, x, y, labelText, width)
  local w = width or 120

  local container = CreateFrame("Frame", nil, parent)
  container:SetWidth(w)
  container:SetHeight(40)
  container:SetPoint("TOPLEFT", parent, "TOPLEFT", x, y)

  local label = container:CreateFontString(nil, "OVERLAY", "GameFontNormal")
  label:SetPoint("TOPLEFT", container, "TOPLEFT", 0, 0)
  label:SetText(labelText or "")

  local box = CreateFrame("Frame", nil, container)
  box:SetPoint("TOPLEFT", label, "BOTTOMLEFT", 0, -4)
  box:SetWidth(w)
  box:SetHeight(22)
  box:SetBackdrop({
    bgFile  = "Interface\\ChatFrame\\ChatFrameBackground",
    edgeFile= "Interface\\Tooltips\\UI-Tooltip-Border",
    tile = true, tileSize = 16, edgeSize = 12,
    insets = { left = 3, right = 3, top = 3, bottom = 3 }
  })
  box:SetBackdropColor(0, 0, 0, 0.8)

  local edit = CreateFrame("EditBox", nil, box)
  edit:SetPoint("TOPLEFT", box, "TOPLEFT", 6, -3)
  edit:SetPoint("BOTTOMRIGHT", box, "BOTTOMRIGHT", -6, 3)
  edit:SetAutoFocus(false)
  edit:SetMultiLine(false)
  edit:SetFontObject(GameFontHighlight)
  edit:SetTextInsets(0, 0, 0, 0)
  edit:SetMaxLetters(256)
  edit:EnableMouse(true)

  -- Eingabe-Handler
  edit:SetScript("OnEscapePressed", function(self) self:ClearFocus() end)
  edit:SetScript("OnEnterPressed", function(self) self:ClearFocus() end)
  -- Tab springt zum nÃ¤chsten Eingabefeld (optional)
  edit:SetScript("OnTabPressed", function(self)
    self:ClearFocus()
    -- Optional: kÃ¶nnte hier Fokus auf nÃ¤chstes Eingabefeld gesetzt werden
  end)

  -- Komfortfunktion
  function edit:SetValueText(t) self:SetText(t or "") end

  return edit, container
end
